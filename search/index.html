---
layout: page
title: Search
body-class: search
---

<h1>Search</h1>
<form>
    <div class="search-form__wrapper">
        <input type="text" name="query" class="search-form__input">
        <button class="search-form__button">
            <svg width="15" height="22"><use xlink:href="#search"></use></svg>
        </button>
        <div class="clear"></div>
    </div>
</form>
<div class="search-results__container">
</div>
<script src="/scripts/lunr.min.js"></script>
<script>
    var data = {
        {% for post in site.posts %}
            "{{ post.url | slugify }}": {
                'id': "{{ post.url | slugify }}",
                'title': "{{ post.title | xml_escape }}",
                'url': "{{ post.url | xml_escape }}"
            }
            {% unless forloop.last %},{% endunless %}
        {% endfor %}
    }

    var idx = lunr(function() {
        this.field('id');
        this.field('title', { boost: 10 });
    });

    for (var key in data) {
        idx.add(data[key])
    }

    document.querySelectorAll('.search-form__button')[0].addEventListener('click', function(e) {
        e.preventDefault();
        var results = idx.search(document.querySelectorAll('.search-form__input')[0].value);
        var html = '';
        if (results.length > 0) {
            html += '<ul>';
            for (var i = 0; i < results.length; i++) {
                var result = data[results[i].ref];
                html += '<li><a href="' + result.url + '">' + result.title + '</a></li>';
            }
            html += '</ul>';
        } else {
            html += 'No Results';
        }
        document.querySelectorAll('.search-results__container')[0].innerHTML = html;
        return false;
    })
</script>
